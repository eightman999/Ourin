# YAYA Core Architecture Diagram

This document provides visual diagrams of the YAYA Core architecture.

---

## System Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Ourin.app (Swift)                        â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  ContentView â”‚  â”‚  DevToolsViewâ”‚  â”‚  Ghost Managerâ”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚         â”‚                                     â”‚                 â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                            â”‚                                     â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚                    â”‚  YayaAdapter   â”‚ â—„â”€â”€ Swift IPC Client     â”‚
â”‚                    â”‚   (Swift)      â”‚                           â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ JSON over Process I/O
                             â”‚ (stdin/stdout, line-based)
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   yaya_core (C++ Executable)                   â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    main.cpp                              â”‚ â”‚
â”‚  â”‚              (IPC Server - JSON Lines)                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                           â”‚                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                     YayaCore                             â”‚ â”‚
â”‚  â”‚              (Command Dispatcher)                        â”‚ â”‚
â”‚  â”‚                                                          â”‚ â”‚
â”‚  â”‚  Commands:                                               â”‚ â”‚
â”‚  â”‚    â€¢ load(ghost_root, dics[], encoding)                 â”‚ â”‚
â”‚  â”‚    â€¢ request(method, id, headers, refs[])               â”‚ â”‚
â”‚  â”‚    â€¢ unload()                                            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                           â”‚                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                DictionaryManager                         â”‚ â”‚
â”‚  â”‚                                                          â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚ Loader       â”‚  â”‚   Parser     â”‚  â”‚   VM         â”‚  â”‚ â”‚
â”‚  â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚  â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ File I/O   â”‚  â”‚ â€¢ Lexer      â”‚  â”‚ â€¢ Execute    â”‚  â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ UTF-8/932  â”‚  â”‚ â€¢ Parser     â”‚  â”‚ â€¢ Variables  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ Validation â”‚  â”‚ â€¢ AST        â”‚  â”‚ â€¢ Functions  â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚                                                          â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚ â”‚
â”‚  â”‚  â”‚BuiltinFuncs  â”‚  â”‚ShioriAdapter â”‚                    â”‚ â”‚
â”‚  â”‚  â”‚              â”‚  â”‚              â”‚                    â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ RAND()     â”‚  â”‚ â€¢ Request    â”‚                    â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ STRLEN()   â”‚  â”‚ â€¢ Response   â”‚                    â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ SUBSTR()   â”‚  â”‚ â€¢ Headers    â”‚                    â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Data Flow: Load Dictionary

```
User Action: Ghost Selection
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ YayaAdapter.swift                                           â”‚
â”‚   adapter.load(                                             â”‚
â”‚     ghostRoot: "/path/to/ghost/master",                    â”‚
â”‚     dics: ["aya_bootend.dic", "aya_menu.dic"],            â”‚
â”‚     encoding: "utf-8"                                       â”‚
â”‚   )                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â”‚ JSON {"cmd":"load", "ghost_root":"...", "dic":[...]}
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ yaya_core: main.cpp                                         â”‚
â”‚   std::getline(std::cin, line)                             â”‚
â”‚   YayaCore::processCommand(line)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DictionaryManager::load(dics, encoding)                     â”‚
â”‚                                                              â”‚
â”‚   FOR EACH dic_file IN dics:                                â”‚
â”‚     1. DictionaryLoader::readFile(path)                     â”‚
â”‚        â”œâ”€ Detect encoding (UTF-8/CP932)                     â”‚
â”‚        â””â”€ Convert to UTF-8                                   â”‚
â”‚                                                              â”‚
â”‚     2. Lexer::tokenize(source)                              â”‚
â”‚        â”œâ”€ Scan characters                                    â”‚
â”‚        â”œâ”€ Identify tokens (keywords, operators, literals)   â”‚
â”‚        â””â”€ Skip comments                                      â”‚
â”‚                                                              â”‚
â”‚     3. Parser::parse(tokens)                                â”‚
â”‚        â”œâ”€ Build Abstract Syntax Tree (AST)                  â”‚
â”‚        â”œâ”€ Validate syntax                                    â”‚
â”‚        â””â”€ Extract function definitions                       â”‚
â”‚                                                              â”‚
â”‚     4. FunctionRegistry::register(functions)                â”‚
â”‚        â””â”€ Store function name â†’ AST mapping                 â”‚
â”‚                                                              â”‚
â”‚   RETURN success/failure                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â”‚ JSON {"ok": true/false}
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ YayaAdapter.swift                                           â”‚
â”‚   return Bool (success/failure)                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Data Flow: Execute Event (GET OnBoot)

```
Event: Ghost Boot
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ YayaAdapter.swift                                           â”‚
â”‚   adapter.request(                                          â”‚
â”‚     method: "GET",                                          â”‚
â”‚     id: "OnBoot",                                           â”‚
â”‚     headers: ["Charset": "UTF-8"],                         â”‚
â”‚     refs: []                                                â”‚
â”‚   )                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â”‚ JSON {"cmd":"request", "method":"GET", "id":"OnBoot", ...}
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ yaya_core: YayaCore::processCommand()                       â”‚
â”‚   DictionaryManager::execute("OnBoot", [])                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DictionaryManager::execute(funcName, args)                  â”‚
â”‚                                                              â”‚
â”‚   1. FunctionRegistry::find("OnBoot")                       â”‚
â”‚      â””â”€ Retrieve function AST                               â”‚
â”‚                                                              â”‚
â”‚   2. VM::execute(function, args)                            â”‚
â”‚      â”œâ”€ Create new call frame                               â”‚
â”‚      â”œâ”€ Set reference[0..n] variables                       â”‚
â”‚      â”‚                                                       â”‚
â”‚      â””â”€ Evaluate AST nodes:                                 â”‚
â”‚          â”‚                                                   â”‚
â”‚          â”œâ”€ Variable assignment                             â”‚
â”‚          â”‚  _var = "value"                                  â”‚
â”‚          â”‚  VariableStore::set("_var", "value")            â”‚
â”‚          â”‚                                                   â”‚
â”‚          â”œâ”€ Function call                                    â”‚
â”‚          â”‚  RAND(10)                                        â”‚
â”‚          â”‚  BuiltinFunctions::call("RAND", [10])           â”‚
â”‚          â”‚                                                   â”‚
â”‚          â”œâ”€ Conditional execution                           â”‚
â”‚          â”‚  if condition { ... } else { ... }              â”‚
â”‚          â”‚                                                   â”‚
â”‚          â””â”€ String concatenation                            â”‚
â”‚             "\0\s[0]" + "Hello" + "\e"                      â”‚
â”‚             = "\0\s[0]Hello\e"                              â”‚
â”‚                                                              â”‚
â”‚   3. Return SakuraScript string                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â”‚ JSON {"ok": true, "status": 200, "value": "\\0\\s[0]Hello\\e"}
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ YayaAdapter.swift                                           â”‚
â”‚   return YayaResponse                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ourin: SakuraScript Renderer                                â”‚
â”‚   Parse: \0 = Sakura scope                                  â”‚
â”‚          \s[0] = Surface 0                                  â”‚
â”‚          Hello = Text                                        â”‚
â”‚          \e = End                                            â”‚
â”‚                                                              â”‚
â”‚   Display in balloon                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Component Responsibilities

### Swift Layer (Ourin.app)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ YayaAdapter.swift                                       â”‚
â”‚                                                         â”‚
â”‚ Responsibilities:                                       â”‚
â”‚  â€¢ Launch yaya_core process                            â”‚
â”‚  â€¢ Manage process lifecycle                            â”‚
â”‚  â€¢ Encode requests to JSON                             â”‚
â”‚  â€¢ Decode responses from JSON                          â”‚
â”‚  â€¢ Handle process termination                          â”‚
â”‚  â€¢ Error propagation to UI                             â”‚
â”‚                                                         â”‚
â”‚ Does NOT:                                               â”‚
â”‚  â€¢ Parse YAYA dictionaries                             â”‚
â”‚  â€¢ Execute YAYA code                                    â”‚
â”‚  â€¢ Understand YAYA syntax                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### C++ Layer (yaya_core)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ main.cpp + YayaCore                                     â”‚
â”‚                                                         â”‚
â”‚ Responsibilities:                                       â”‚
â”‚  â€¢ Read JSON from stdin                                â”‚
â”‚  â€¢ Write JSON to stdout                                â”‚
â”‚  â€¢ Dispatch commands                                    â”‚
â”‚  â€¢ Top-level error handling                            â”‚
â”‚                                                         â”‚
â”‚ Does NOT:                                               â”‚
â”‚  â€¢ Know about Swift                                     â”‚
â”‚  â€¢ Access UI                                            â”‚
â”‚  â€¢ Manage ghost files                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DictionaryManager                                       â”‚
â”‚                                                         â”‚
â”‚ Responsibilities:                                       â”‚
â”‚  â€¢ Load and parse .dic files                           â”‚
â”‚  â€¢ Manage function registry                            â”‚
â”‚  â€¢ Execute YAYA functions                              â”‚
â”‚  â€¢ Coordinate Lexer/Parser/VM                          â”‚
â”‚                                                         â”‚
â”‚ Does NOT:                                               â”‚
â”‚  â€¢ Render SakuraScript                                 â”‚
â”‚  â€¢ Manage ghost lifecycle                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Lexer + Parser                                          â”‚
â”‚                                                         â”‚
â”‚ Responsibilities:                                       â”‚
â”‚  â€¢ Tokenize YAYA source code                           â”‚
â”‚  â€¢ Build Abstract Syntax Tree                          â”‚
â”‚  â€¢ Syntax validation                                    â”‚
â”‚  â€¢ Error reporting                                      â”‚
â”‚                                                         â”‚
â”‚ Does NOT:                                               â”‚
â”‚  â€¢ Execute code                                         â”‚
â”‚  â€¢ Manage variables                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ VM (Virtual Machine)                                    â”‚
â”‚                                                         â”‚
â”‚ Responsibilities:                                       â”‚
â”‚  â€¢ Execute AST nodes                                    â”‚
â”‚  â€¢ Manage variables (local + global)                   â”‚
â”‚  â€¢ Call built-in functions                             â”‚
â”‚  â€¢ Handle control flow (if/while/return)               â”‚
â”‚  â€¢ Stack management                                     â”‚
â”‚                                                         â”‚
â”‚ Does NOT:                                               â”‚
â”‚  â€¢ Parse source code                                    â”‚
â”‚  â€¢ Load files                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BuiltinFunctions                                        â”‚
â”‚                                                         â”‚
â”‚ Responsibilities:                                       â”‚
â”‚  â€¢ Implement YAYA built-in functions                   â”‚
â”‚  â€¢ Type conversion                                      â”‚
â”‚  â€¢ String manipulation                                  â”‚
â”‚  â€¢ Random number generation                            â”‚
â”‚  â€¢ Array operations                                     â”‚
â”‚                                                         â”‚
â”‚ Does NOT:                                               â”‚
â”‚  â€¢ Parse code                                           â”‚
â”‚  â€¢ Manage user-defined functions                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ShioriAdapter                                           â”‚
â”‚                                                         â”‚
â”‚ Responsibilities:                                       â”‚
â”‚  â€¢ Map SHIORI requests to YAYA functions               â”‚
â”‚  â€¢ Set reference[] variables                           â”‚
â”‚  â€¢ Format SHIORI responses                             â”‚
â”‚  â€¢ Handle status codes                                  â”‚
â”‚                                                         â”‚
â”‚ Does NOT:                                               â”‚
â”‚  â€¢ Execute YAYA code directly                          â”‚
â”‚  â€¢ Parse dictionaries                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Implementation Status

```
Component             Status      Phase
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
main.cpp              âœ… Done     -
YayaCore              âœ… Done     -
YayaAdapter.swift     âœ… Done     -
DictionaryManager     âš ï¸  Stub    Phase 1
Lexer                 âŒ TODO     Phase 1 Week 1
Parser                âŒ TODO     Phase 1 Week 1-2
AST                   âŒ TODO     Phase 1 Week 1-2
VM                    âŒ TODO     Phase 1 Week 2
Value                 âŒ TODO     Phase 1 Week 2
VariableStore         âŒ TODO     Phase 1 Week 2
FunctionRegistry      âŒ TODO     Phase 1 Week 2
BuiltinFunctions      âŒ TODO     Phase 1 Week 2-3
ShioriAdapter         âŒ TODO     Phase 1 Week 3
Encoding Support      âŒ TODO     Phase 1 Week 1
Error Handling        âŒ TODO     Phase 1 Week 3
Unit Tests            âŒ TODO     Phase 1 Week 1-3
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Arrays/Dicts          âŒ TODO     Phase 2
Loops                 âŒ TODO     Phase 2
Regex                 âŒ TODO     Phase 2
Performance Opt       âŒ TODO     Phase 2-3
```

---

## Directory Layout

```
/home/runner/work/Ourin/Ourin/
â”‚
â”œâ”€â”€ yaya_core/                      # C++ YAYA Core Module
â”‚   â”œâ”€â”€ CMakeLists.txt              # Build config (Universal Binary)
â”‚   â”œâ”€â”€ README.md                   # Quick start guide
â”‚   â”œâ”€â”€ .gitignore                  # Build artifacts exclusion
â”‚   â”‚
â”‚   â”œâ”€â”€ src/                        # Source code
â”‚   â”‚   â”œâ”€â”€ main.cpp                # âœ… IPC entry point
â”‚   â”‚   â”œâ”€â”€ YayaCore.{cpp,hpp}      # âœ… Command dispatcher
â”‚   â”‚   â”œâ”€â”€ DictionaryManager.{cpp,hpp}  # âš ï¸ Stub only
â”‚   â”‚   â”œâ”€â”€ Lexer.{cpp,hpp}         # âŒ TODO Phase 1
â”‚   â”‚   â”œâ”€â”€ Parser.{cpp,hpp}        # âŒ TODO Phase 1
â”‚   â”‚   â”œâ”€â”€ AST.{cpp,hpp}           # âŒ TODO Phase 1
â”‚   â”‚   â”œâ”€â”€ VM.{cpp,hpp}            # âŒ TODO Phase 1
â”‚   â”‚   â”œâ”€â”€ Value.{cpp,hpp}         # âŒ TODO Phase 1
â”‚   â”‚   â”œâ”€â”€ VariableStore.{cpp,hpp} # âŒ TODO Phase 1
â”‚   â”‚   â”œâ”€â”€ FunctionRegistry.{cpp,hpp}  # âŒ TODO Phase 1
â”‚   â”‚   â”œâ”€â”€ BuiltinFunctions.{cpp,hpp}  # âŒ TODO Phase 1
â”‚   â”‚   â”œâ”€â”€ ShioriAdapter.{cpp,hpp}     # âŒ TODO Phase 1
â”‚   â”‚   â””â”€â”€ Utils.{cpp,hpp}         # âŒ TODO Phase 1
â”‚   â”‚
â”‚   â”œâ”€â”€ tests/                      # âŒ TODO Phase 1
â”‚   â”‚   â”œâ”€â”€ lexer_test.cpp
â”‚   â”‚   â”œâ”€â”€ parser_test.cpp
â”‚   â”‚   â”œâ”€â”€ vm_test.cpp
â”‚   â”‚   â””â”€â”€ integration_test.cpp
â”‚   â”‚
â”‚   â””â”€â”€ build/                      # Git-ignored build directory
â”‚
â”œâ”€â”€ Ourin/Yaya/                     # Swift Integration
â”‚   â””â”€â”€ YayaAdapter.swift           # âœ… Process manager + IPC client
â”‚
â”œâ”€â”€ docs/                           # Documentation
â”‚   â”œâ”€â”€ YAYA_CORE_INVESTIGATION_REPORT.md      # ğŸ†• èª¿æŸ»å ±å‘Š
â”‚   â”œâ”€â”€ YAYA_CORE_IMPLEMENTATION_PLAN.md       # ğŸ†• å®Ÿè£…è¨ˆç”»
â”‚   â”œâ”€â”€ YAYA_CORE_TECHNICAL_SPEC.md            # ğŸ†• æŠ€è¡“ä»•æ§˜
â”‚   â”œâ”€â”€ YAYA_CORE_EXECUTIVE_SUMMARY.md         # ğŸ†• ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ã‚µãƒãƒªãƒ¼
â”‚   â”œâ”€â”€ YAYA_CORE_ARCHITECTURE.md              # ğŸ†• This file
â”‚   â”œâ”€â”€ OURIN_YAYA_ADAPTER_SPEC_1.0M.md        # âœ… IPCä»•æ§˜
â”‚   â””â”€â”€ OURIN_USL_1.0M_SPEC.md                 # âœ… USLä»•æ§˜
â”‚
â””â”€â”€ emily4/                         # Test Data
    â””â”€â”€ ghost/master/*.dic          # 50+ YAYA dictionary files
```

---

**Document**: Architecture Diagram  
**Created**: 2025-10-16  
**Project**: Ourin (eightman999/Ourin)
