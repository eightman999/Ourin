<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ourin DevTools UI Mockup</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Helvetica Neue", "Hiragino Kaku Gothic ProN", "Hiragino Sans", "游ゴシック", YuGothic, "メイリオ", Meiryo, sans-serif;
            line-height: 1.6;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .content {
            background-color: white;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            border-bottom: 3px solid #333;
            padding-bottom: 10px;
            color: #333;
        }
        h2 {
            border-bottom: 2px solid #666;
            padding-bottom: 8px;
            margin-top: 30px;
            color: #444;
        }
        h3 {
            margin-top: 25px;
            color: #555;
        }
        code {
            background-color: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: "SF Mono", "Menlo", "Monaco", "Courier New", monospace;
            font-size: 0.9em;
        }
        pre {
            background-color: #f4f4f4;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            border-left: 4px solid #333;
        }
        pre code {
            background-color: transparent;
            padding: 0;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #f8f8f8;
            font-weight: bold;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        a {
            color: #0066cc;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        blockquote {
            border-left: 4px solid #ddd;
            padding-left: 20px;
            margin-left: 0;
            color: #666;
            font-style: italic;
        }
        ul, ol {
            padding-left: 30px;
        }
        li {
            margin: 8px 0;
        }
        hr {
            border: none;
            border-top: 2px solid #ddd;
            margin: 30px 0;
        }
        .toc {
            background-color: #f8f8f8;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
        }
        input[type="checkbox"] {
            margin-right: 8px;
        }
        .footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #ddd;
            text-align: center;
            color: #666;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div class="content">
        <h1 id="ourin-devtools-ui-mockup">Ourin DevTools UI Mockup</h1>
<p>This document outlines a proposed "Settings, Test &amp; Debug" interface for <strong>Ourin</strong> on macOS. The mockup follows Apple's Human Interface Guidelines and utilises the standard Sidebar + Toolbar layout with a detail view on the right.</p>
<h2 id="0-screen-map">0. Screen Map</h2>
<pre><code>┌──────────────────────────────────────────────────────────────┐
│  Ourin DevTools                                      [Search]│
│  ─────────────────────────────────────────────────────────── │
│  ▸ General                                                  ││
│  ▸ SHIORI Resource                                          ││
│  ▸ Plugins &amp; Events                                         ││  ← Sidebar
│  ▸ External (SSTP/HTTP/XPC)                                 ││     Section + Items
│  ▸ Headline / Balloon                                       ││
│  ▸ Logging &amp; Diagnostics                                    ││
│  ▸ Network                                                  ││
│                                                              │
│  ─────────────────────────────────────────────────────────── │
│  [Toolbar:  ⟳ Reload   ▶ Run Test   ⏹ Stop   ⎘ Export  ]    │
│  ─────────────────────────────────────────────────────────── │
│  [Detail View / Form / Table / Live Preview / Log Console]  │
└──────────────────────────────────────────────────────────────┘
</code></pre>
<p>The sidebar offers consistent navigation while the right pane hosts searchable tables and forms. Toolbar buttons are limited to reloading, running tests, stopping tasks and exporting.</p>
<h2 id="1-common-ui-guidelines">1. Common UI Guidelines</h2>
<ul>
<li>Search fields filter lists/tables in each pane.</li>
<li>Toolbar keeps button count small, following HIG recommendations.</li>
<li>Status badges appear at the top‑right (success/warning/error).</li>
<li>Shortcuts: <strong>⌘R</strong> run, <strong>⌘S</strong> save/export, <strong>⌘F</strong> search.</li>
<li>Operations log to <code>Logger</code> (subsystem <code>jp.ourin.devtools</code>, category <code>ui</code>).</li>
</ul>
<h2 id="2-pane-mockups">2. Pane Mockups</h2>
<h3 id="21-general">2.1 General</h3>
<p>Edit global defaults such as:
- Data folder path (<code>POSIX/file://</code>)
- Default encoding (UTF‑8 with optional CP932)
- Rosetta detection (read‑only)
- Auto‑start and update checks</p>
<p>Validation confirms path existence and write permissions. Saving emits a log entry (<code>settings</code> category).</p>
<h3 id="22-shiori-resource-vieweroverlay">2.2 SHIORI Resource Viewer/Overlay</h3>
<ul>
<li>Segment control: All | SHIORI | Ghost | Menu | Colors | Update</li>
<li>Table columns: Key, Value (read‑only), Overlay (Ourin), Effective, Last Fetched</li>
<li>Right pane previews colours or bitmaps.</li>
<li>Reload resources, apply or clear overlays. Applying fires a signpost <code>apply_resource_overlay</code>.</li>
</ul>
<h3 id="23-plugin-manager-event-injector">2.3 Plugin Manager / Event Injector</h3>
<ul>
<li>Left list: plugins (enabled, ID, version, path)</li>
<li>Right form injects events: Event ID, ReferenceN fields, Sender and Charset</li>
<li>Send (GET) / Notify buttons, presets can be saved</li>
<li>Logging around injection uses category <code>plugin</code>; signpost <code>inject_event</code> records duration.</li>
</ul>
<h3 id="24-external-events-harness">2.4 External Events Harness</h3>
<p>Manage SSTP/HTTP/XPC listeners.
- TCP (9801) start/stop, binding address, status
- HTTP POST <code>/api/sstp/v1</code> start/stop, stats
- XPC service <code>jp.ourin.sstp</code> start/stop, client list
- Provide sample requests for SSTP/HTTP and minimal XPC snippets.</p>
<h3 id="25-headline-balloon-test">2.5 Headline / Balloon Test</h3>
<ul>
<li>Headline: configure URL/path and view the response table</li>
<li>Balloon: choose shell/balloon, preview PNG with scale/DPI and anchor layout</li>
</ul>
<h3 id="26-logging-diagnostics">2.6 Logging &amp; Diagnostics</h3>
<ul>
<li>Query bar: subsystem (default <code>jp.ourin.*</code>), category, level and time range</li>
<li>Table shows time, level, category, message and metadata</li>
<li>Signpost timeline visualises durations using <code>OSSignposter</code></li>
</ul>
<h3 id="27-network-listener-status">2.7 Network &amp; Listener Status</h3>
<ul>
<li>Monitor current connections and throughput for SSTP/HTTP/XPC</li>
<li>Display counters such as 2xx/4xx/5xx for HTTP and average processing time</li>
</ul>
<h2 id="3-test-scenarios">3. Test Scenarios</h2>
<ul>
<li><strong>Ghost Boot → Menu Exec → Exit</strong> (signpost <code>scenario_boot_menu_exit</code>)</li>
<li>External NOTIFY round‑trip via TCP 9801</li>
<li>HTTP <code>SEND</code> via <code>/api/sstp/v1</code></li>
<li>Direct XPC delivery including oversize handling</li>
</ul>
<h2 id="4-accessibility-internationalisation">4. Accessibility &amp; Internationalisation</h2>
<ul>
<li>VoiceOver labels for table columns</li>
<li>Keyboard shortcuts for switching sidebar/detail panes</li>
<li>Runtime locale switching with line height auto‑adjust</li>
</ul>
<h2 id="5-log-collection-export">5. Log Collection &amp; Export</h2>
<p><code>File &gt; Export Diagnostics…</code> bundles OSLog extraction, signposts, settings snapshots and environment info into a zip archive.</p>
<h2 id="6-known-issues-tbd">6. Known Issues / TBD</h2>
<ul>
<li>Paging long resource lists and overlay timing</li>
<li>Signpost naming: <code>ourin.resource.apply</code>, <code>ourin.plugin.inject</code>, <code>ourin.net.sstp</code>, etc.</li>
<li>XPC permission requirements and UI exposure</li>
<li>Network permission explanations</li>
</ul>
<hr />
<p><em>Last updated: 2025‑07‑27</em></p>
        <div class="footer">
            <p>Ourin (桜鈴) - macOS ネイティブ伺かベースウェア</p>
        </div>
    </div>
</body>
</html>