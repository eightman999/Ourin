<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YAYA Core Architecture Diagram</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Helvetica Neue", "Hiragino Kaku Gothic ProN", "Hiragino Sans", "æ¸¸ã‚´ã‚·ãƒƒã‚¯", YuGothic, "ãƒ¡ã‚¤ãƒªã‚ª", Meiryo, sans-serif;
            line-height: 1.6;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .content {
            background-color: white;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            border-bottom: 3px solid #333;
            padding-bottom: 10px;
            color: #333;
        }
        h2 {
            border-bottom: 2px solid #666;
            padding-bottom: 8px;
            margin-top: 30px;
            color: #444;
        }
        h3 {
            margin-top: 25px;
            color: #555;
        }
        code {
            background-color: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: "SF Mono", "Menlo", "Monaco", "Courier New", monospace;
            font-size: 0.9em;
        }
        pre {
            background-color: #f4f4f4;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            border-left: 4px solid #333;
        }
        pre code {
            background-color: transparent;
            padding: 0;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #f8f8f8;
            font-weight: bold;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        a {
            color: #0066cc;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        blockquote {
            border-left: 4px solid #ddd;
            padding-left: 20px;
            margin-left: 0;
            color: #666;
            font-style: italic;
        }
        ul, ol {
            padding-left: 30px;
        }
        li {
            margin: 8px 0;
        }
        hr {
            border: none;
            border-top: 2px solid #ddd;
            margin: 30px 0;
        }
        .toc {
            background-color: #f8f8f8;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
        }
        input[type="checkbox"] {
            margin-right: 8px;
        }
        .footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #ddd;
            text-align: center;
            color: #666;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div class="content">
        <h1 id="yaya-core-architecture-diagram">YAYA Core Architecture Diagram</h1>
<p>This document provides visual diagrams of the YAYA Core architecture.</p>
<hr />
<h2 id="system-overview">System Overview</h2>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Ourin.app (Swift)                        â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  ContentView â”‚  â”‚  DevToolsViewâ”‚  â”‚  Ghost Managerâ”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚         â”‚                                     â”‚                 â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                            â”‚                                     â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚                    â”‚  YayaAdapter   â”‚ â—„â”€â”€ Swift IPC Client     â”‚
â”‚                    â”‚   (Swift)      â”‚                           â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ JSON over Process I/O
                             â”‚ (stdin/stdout, line-based)
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   yaya_core (C++ Executable)                   â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    main.cpp                              â”‚ â”‚
â”‚  â”‚              (IPC Server - JSON Lines)                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                           â”‚                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                     YayaCore                             â”‚ â”‚
â”‚  â”‚              (Command Dispatcher)                        â”‚ â”‚
â”‚  â”‚                                                          â”‚ â”‚
â”‚  â”‚  Commands:                                               â”‚ â”‚
â”‚  â”‚    â€¢ load(ghost_root, dics[], encoding)                 â”‚ â”‚
â”‚  â”‚    â€¢ request(method, id, headers, refs[])               â”‚ â”‚
â”‚  â”‚    â€¢ unload()                                            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                           â”‚                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                DictionaryManager                         â”‚ â”‚
â”‚  â”‚                                                          â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚ Loader       â”‚  â”‚   Parser     â”‚  â”‚   VM         â”‚  â”‚ â”‚
â”‚  â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚  â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ File I/O   â”‚  â”‚ â€¢ Lexer      â”‚  â”‚ â€¢ Execute    â”‚  â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ UTF-8/932  â”‚  â”‚ â€¢ Parser     â”‚  â”‚ â€¢ Variables  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ Validation â”‚  â”‚ â€¢ AST        â”‚  â”‚ â€¢ Functions  â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚                                                          â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚ â”‚
â”‚  â”‚  â”‚BuiltinFuncs  â”‚  â”‚ShioriAdapter â”‚                    â”‚ â”‚
â”‚  â”‚  â”‚              â”‚  â”‚              â”‚                    â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ RAND()     â”‚  â”‚ â€¢ Request    â”‚                    â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ STRLEN()   â”‚  â”‚ â€¢ Response   â”‚                    â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ SUBSTR()   â”‚  â”‚ â€¢ Headers    â”‚                    â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<hr />
<h2 id="data-flow-load-dictionary">Data Flow: Load Dictionary</h2>
<pre><code>User Action: Ghost Selection
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ YayaAdapter.swift                                           â”‚
â”‚   adapter.load(                                             â”‚
â”‚     ghostRoot: &quot;/path/to/ghost/master&quot;,                    â”‚
â”‚     dics: [&quot;aya_bootend.dic&quot;, &quot;aya_menu.dic&quot;],            â”‚
â”‚     encoding: &quot;utf-8&quot;                                       â”‚
â”‚   )                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â”‚ JSON {&quot;cmd&quot;:&quot;load&quot;, &quot;ghost_root&quot;:&quot;...&quot;, &quot;dic&quot;:[...]}
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ yaya_core: main.cpp                                         â”‚
â”‚   std::getline(std::cin, line)                             â”‚
â”‚   YayaCore::processCommand(line)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DictionaryManager::load(dics, encoding)                     â”‚
â”‚                                                              â”‚
â”‚   FOR EACH dic_file IN dics:                                â”‚
â”‚     1. DictionaryLoader::readFile(path)                     â”‚
â”‚        â”œâ”€ Detect encoding (UTF-8/CP932)                     â”‚
â”‚        â””â”€ Convert to UTF-8                                   â”‚
â”‚                                                              â”‚
â”‚     2. Lexer::tokenize(source)                              â”‚
â”‚        â”œâ”€ Scan characters                                    â”‚
â”‚        â”œâ”€ Identify tokens (keywords, operators, literals)   â”‚
â”‚        â””â”€ Skip comments                                      â”‚
â”‚                                                              â”‚
â”‚     3. Parser::parse(tokens)                                â”‚
â”‚        â”œâ”€ Build Abstract Syntax Tree (AST)                  â”‚
â”‚        â”œâ”€ Validate syntax                                    â”‚
â”‚        â””â”€ Extract function definitions                       â”‚
â”‚                                                              â”‚
â”‚     4. FunctionRegistry::register(functions)                â”‚
â”‚        â””â”€ Store function name â†’ AST mapping                 â”‚
â”‚                                                              â”‚
â”‚   RETURN success/failure                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â”‚ JSON {&quot;ok&quot;: true/false}
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ YayaAdapter.swift                                           â”‚
â”‚   return Bool (success/failure)                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<hr />
<h2 id="data-flow-execute-event-get-onboot">Data Flow: Execute Event (GET OnBoot)</h2>
<pre><code>Event: Ghost Boot
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ YayaAdapter.swift                                           â”‚
â”‚   adapter.request(                                          â”‚
â”‚     method: &quot;GET&quot;,                                          â”‚
â”‚     id: &quot;OnBoot&quot;,                                           â”‚
â”‚     headers: [&quot;Charset&quot;: &quot;UTF-8&quot;],                         â”‚
â”‚     refs: []                                                â”‚
â”‚   )                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â”‚ JSON {&quot;cmd&quot;:&quot;request&quot;, &quot;method&quot;:&quot;GET&quot;, &quot;id&quot;:&quot;OnBoot&quot;, ...}
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ yaya_core: YayaCore::processCommand()                       â”‚
â”‚   DictionaryManager::execute(&quot;OnBoot&quot;, [])                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DictionaryManager::execute(funcName, args)                  â”‚
â”‚                                                              â”‚
â”‚   1. FunctionRegistry::find(&quot;OnBoot&quot;)                       â”‚
â”‚      â””â”€ Retrieve function AST                               â”‚
â”‚                                                              â”‚
â”‚   2. VM::execute(function, args)                            â”‚
â”‚      â”œâ”€ Create new call frame                               â”‚
â”‚      â”œâ”€ Set reference[0..n] variables                       â”‚
â”‚      â”‚                                                       â”‚
â”‚      â””â”€ Evaluate AST nodes:                                 â”‚
â”‚          â”‚                                                   â”‚
â”‚          â”œâ”€ Variable assignment                             â”‚
â”‚          â”‚  _var = &quot;value&quot;                                  â”‚
â”‚          â”‚  VariableStore::set(&quot;_var&quot;, &quot;value&quot;)            â”‚
â”‚          â”‚                                                   â”‚
â”‚          â”œâ”€ Function call                                    â”‚
â”‚          â”‚  RAND(10)                                        â”‚
â”‚          â”‚  BuiltinFunctions::call(&quot;RAND&quot;, [10])           â”‚
â”‚          â”‚                                                   â”‚
â”‚          â”œâ”€ Conditional execution                           â”‚
â”‚          â”‚  if condition { ... } else { ... }              â”‚
â”‚          â”‚                                                   â”‚
â”‚          â””â”€ String concatenation                            â”‚
â”‚             &quot;\0\s[0]&quot; + &quot;Hello&quot; + &quot;\e&quot;                      â”‚
â”‚             = &quot;\0\s[0]Hello\e&quot;                              â”‚
â”‚                                                              â”‚
â”‚   3. Return SakuraScript string                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â”‚ JSON {&quot;ok&quot;: true, &quot;status&quot;: 200, &quot;value&quot;: &quot;\\0\\s[0]Hello\\e&quot;}
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ YayaAdapter.swift                                           â”‚
â”‚   return YayaResponse                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ourin: SakuraScript Renderer                                â”‚
â”‚   Parse: \0 = Sakura scope                                  â”‚
â”‚          \s[0] = Surface 0                                  â”‚
â”‚          Hello = Text                                        â”‚
â”‚          \e = End                                            â”‚
â”‚                                                              â”‚
â”‚   Display in balloon                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<hr />
<h2 id="component-responsibilities">Component Responsibilities</h2>
<h3 id="swift-layer-ourinapp">Swift Layer (Ourin.app)</h3>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ YayaAdapter.swift                                       â”‚
â”‚                                                         â”‚
â”‚ Responsibilities:                                       â”‚
â”‚  â€¢ Launch yaya_core process                            â”‚
â”‚  â€¢ Manage process lifecycle                            â”‚
â”‚  â€¢ Encode requests to JSON                             â”‚
â”‚  â€¢ Decode responses from JSON                          â”‚
â”‚  â€¢ Handle process termination                          â”‚
â”‚  â€¢ Error propagation to UI                             â”‚
â”‚                                                         â”‚
â”‚ Does NOT:                                               â”‚
â”‚  â€¢ Parse YAYA dictionaries                             â”‚
â”‚  â€¢ Execute YAYA code                                    â”‚
â”‚  â€¢ Understand YAYA syntax                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 id="c-layer-yaya_core">C++ Layer (yaya_core)</h3>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ main.cpp + YayaCore                                     â”‚
â”‚                                                         â”‚
â”‚ Responsibilities:                                       â”‚
â”‚  â€¢ Read JSON from stdin                                â”‚
â”‚  â€¢ Write JSON to stdout                                â”‚
â”‚  â€¢ Dispatch commands                                    â”‚
â”‚  â€¢ Top-level error handling                            â”‚
â”‚                                                         â”‚
â”‚ Does NOT:                                               â”‚
â”‚  â€¢ Know about Swift                                     â”‚
â”‚  â€¢ Access UI                                            â”‚
â”‚  â€¢ Manage ghost files                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DictionaryManager                                       â”‚
â”‚                                                         â”‚
â”‚ Responsibilities:                                       â”‚
â”‚  â€¢ Load and parse .dic files                           â”‚
â”‚  â€¢ Manage function registry                            â”‚
â”‚  â€¢ Execute YAYA functions                              â”‚
â”‚  â€¢ Coordinate Lexer/Parser/VM                          â”‚
â”‚                                                         â”‚
â”‚ Does NOT:                                               â”‚
â”‚  â€¢ Render SakuraScript                                 â”‚
â”‚  â€¢ Manage ghost lifecycle                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Lexer + Parser                                          â”‚
â”‚                                                         â”‚
â”‚ Responsibilities:                                       â”‚
â”‚  â€¢ Tokenize YAYA source code                           â”‚
â”‚  â€¢ Build Abstract Syntax Tree                          â”‚
â”‚  â€¢ Syntax validation                                    â”‚
â”‚  â€¢ Error reporting                                      â”‚
â”‚                                                         â”‚
â”‚ Does NOT:                                               â”‚
â”‚  â€¢ Execute code                                         â”‚
â”‚  â€¢ Manage variables                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ VM (Virtual Machine)                                    â”‚
â”‚                                                         â”‚
â”‚ Responsibilities:                                       â”‚
â”‚  â€¢ Execute AST nodes                                    â”‚
â”‚  â€¢ Manage variables (local + global)                   â”‚
â”‚  â€¢ Call built-in functions                             â”‚
â”‚  â€¢ Handle control flow (if/while/return)               â”‚
â”‚  â€¢ Stack management                                     â”‚
â”‚                                                         â”‚
â”‚ Does NOT:                                               â”‚
â”‚  â€¢ Parse source code                                    â”‚
â”‚  â€¢ Load files                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BuiltinFunctions                                        â”‚
â”‚                                                         â”‚
â”‚ Responsibilities:                                       â”‚
â”‚  â€¢ Implement YAYA built-in functions                   â”‚
â”‚  â€¢ Type conversion                                      â”‚
â”‚  â€¢ String manipulation                                  â”‚
â”‚  â€¢ Random number generation                            â”‚
â”‚  â€¢ Array operations                                     â”‚
â”‚                                                         â”‚
â”‚ Does NOT:                                               â”‚
â”‚  â€¢ Parse code                                           â”‚
â”‚  â€¢ Manage user-defined functions                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ShioriAdapter                                           â”‚
â”‚                                                         â”‚
â”‚ Responsibilities:                                       â”‚
â”‚  â€¢ Map SHIORI requests to YAYA functions               â”‚
â”‚  â€¢ Set reference[] variables                           â”‚
â”‚  â€¢ Format SHIORI responses                             â”‚
â”‚  â€¢ Handle status codes                                  â”‚
â”‚                                                         â”‚
â”‚ Does NOT:                                               â”‚
â”‚  â€¢ Execute YAYA code directly                          â”‚
â”‚  â€¢ Parse dictionaries                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<hr />
<h2 id="implementation-status">Implementation Status</h2>
<pre><code>Component             Status      Phase
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
main.cpp              âœ… Done     -
YayaCore              âœ… Done     -
YayaAdapter.swift     âœ… Done     -
DictionaryManager     âš ï¸  Stub    Phase 1
Lexer                 âŒ TODO     Phase 1 Week 1
Parser                âŒ TODO     Phase 1 Week 1-2
AST                   âŒ TODO     Phase 1 Week 1-2
VM                    âŒ TODO     Phase 1 Week 2
Value                 âŒ TODO     Phase 1 Week 2
VariableStore         âŒ TODO     Phase 1 Week 2
FunctionRegistry      âŒ TODO     Phase 1 Week 2
BuiltinFunctions      âŒ TODO     Phase 1 Week 2-3
ShioriAdapter         âŒ TODO     Phase 1 Week 3
Encoding Support      âŒ TODO     Phase 1 Week 1
Error Handling        âŒ TODO     Phase 1 Week 3
Unit Tests            âŒ TODO     Phase 1 Week 1-3
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Arrays/Dicts          âŒ TODO     Phase 2
Loops                 âŒ TODO     Phase 2
Regex                 âŒ TODO     Phase 2
Performance Opt       âŒ TODO     Phase 2-3
</code></pre>
<hr />
<h2 id="directory-layout">Directory Layout</h2>
<pre><code>/home/runner/work/Ourin/Ourin/
â”‚
â”œâ”€â”€ yaya_core/                      # C++ YAYA Core Module
â”‚   â”œâ”€â”€ CMakeLists.txt              # Build config (Universal Binary)
â”‚   â”œâ”€â”€ README.md                   # Quick start guide
â”‚   â”œâ”€â”€ .gitignore                  # Build artifacts exclusion
â”‚   â”‚
â”‚   â”œâ”€â”€ src/                        # Source code
â”‚   â”‚   â”œâ”€â”€ main.cpp                # âœ… IPC entry point
â”‚   â”‚   â”œâ”€â”€ YayaCore.{cpp,hpp}      # âœ… Command dispatcher
â”‚   â”‚   â”œâ”€â”€ DictionaryManager.{cpp,hpp}  # âš ï¸ Stub only
â”‚   â”‚   â”œâ”€â”€ Lexer.{cpp,hpp}         # âŒ TODO Phase 1
â”‚   â”‚   â”œâ”€â”€ Parser.{cpp,hpp}        # âŒ TODO Phase 1
â”‚   â”‚   â”œâ”€â”€ AST.{cpp,hpp}           # âŒ TODO Phase 1
â”‚   â”‚   â”œâ”€â”€ VM.{cpp,hpp}            # âŒ TODO Phase 1
â”‚   â”‚   â”œâ”€â”€ Value.{cpp,hpp}         # âŒ TODO Phase 1
â”‚   â”‚   â”œâ”€â”€ VariableStore.{cpp,hpp} # âŒ TODO Phase 1
â”‚   â”‚   â”œâ”€â”€ FunctionRegistry.{cpp,hpp}  # âŒ TODO Phase 1
â”‚   â”‚   â”œâ”€â”€ BuiltinFunctions.{cpp,hpp}  # âŒ TODO Phase 1
â”‚   â”‚   â”œâ”€â”€ ShioriAdapter.{cpp,hpp}     # âŒ TODO Phase 1
â”‚   â”‚   â””â”€â”€ Utils.{cpp,hpp}         # âŒ TODO Phase 1
â”‚   â”‚
â”‚   â”œâ”€â”€ tests/                      # âŒ TODO Phase 1
â”‚   â”‚   â”œâ”€â”€ lexer_test.cpp
â”‚   â”‚   â”œâ”€â”€ parser_test.cpp
â”‚   â”‚   â”œâ”€â”€ vm_test.cpp
â”‚   â”‚   â””â”€â”€ integration_test.cpp
â”‚   â”‚
â”‚   â””â”€â”€ build/                      # Git-ignored build directory
â”‚
â”œâ”€â”€ Ourin/Yaya/                     # Swift Integration
â”‚   â””â”€â”€ YayaAdapter.swift           # âœ… Process manager + IPC client
â”‚
â”œâ”€â”€ docs/                           # Documentation
â”‚   â”œâ”€â”€ YAYA_CORE_INVESTIGATION_REPORT.md      # ğŸ†• èª¿æŸ»å ±å‘Š
â”‚   â”œâ”€â”€ YAYA_CORE_IMPLEMENTATION_PLAN.md       # ğŸ†• å®Ÿè£…è¨ˆç”»
â”‚   â”œâ”€â”€ YAYA_CORE_TECHNICAL_SPEC.md            # ğŸ†• æŠ€è¡“ä»•æ§˜
â”‚   â”œâ”€â”€ YAYA_CORE_EXECUTIVE_SUMMARY.md         # ğŸ†• ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ã‚µãƒãƒªãƒ¼
â”‚   â”œâ”€â”€ YAYA_CORE_ARCHITECTURE.md              # ğŸ†• This file
â”‚   â”œâ”€â”€ OURIN_YAYA_ADAPTER_SPEC_1.0M.md        # âœ… IPCä»•æ§˜
â”‚   â””â”€â”€ OURIN_USL_1.0M_SPEC.md                 # âœ… USLä»•æ§˜
â”‚
â””â”€â”€ emily4/                         # Test Data
    â””â”€â”€ ghost/master/*.dic          # 50+ YAYA dictionary files
</code></pre>
<hr />
<p><strong>Document</strong>: Architecture Diagram<br />
<strong>Created</strong>: 2025-10-16<br />
<strong>Project</strong>: Ourin (eightman999/Ourin)</p>
        <div class="footer">
            <p>Ourin (æ¡œéˆ´) - macOS ãƒã‚¤ãƒ†ã‚£ãƒ–ä¼ºã‹ãƒ™ãƒ¼ã‚¹ã‚¦ã‚§ã‚¢</p>
        </div>
    </div>
</body>
</html>